var events=new Events,simplexNoise=new SimplexNoise;"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1);var UberVizMain=function(){function a(){Detector.webgl||Detector.addGetWebGLMessage(),document.onselectstart=function(){return!1},document.addEventListener("mousemove",h,!1),document.addEventListener("mousedown",f,!1),document.addEventListener("mouseup",g,!1),document.addEventListener("dragover",c,!1),window.addEventListener("resize",i,!1),window.addEventListener("keydown",d,!1),window.addEventListener("keyup",e,!1),m=new Stats,$("#controls").append(m.domElement),m.domElement.id="stats",AudioHandler.init(),VizHandler.init(),FXHandler.init(),i(),b()}function b(){requestAnimationFrame(b),m.update(),events.emit("update")}function c(a){return a.stopPropagation(),a.preventDefault(),!1}function d(a){switch(a.keyCode){case 32:VizHandler.setBeat(Math.random()+.1);break;case 81:}}function e(){}function f(){}function g(){}function h(){}function i(){VizHandler.onResize()}function j(a){$("#debugText").text(a)}function k(){VizHandler.setBeat(Math.random()+.1)}function l(){window.orientation%180==0}var m;return window.onorientationchange=l,window.setTimeout(l,0),{init:a,setBeat:k,trace:j}}();$(document).ready(function(){function a(){$(".trigger").show(),$("body").bind("touchstart",function(){$(".trigger").addClass("recording"),"shake"!=o?g():n.start(),$("#status").text("Touch Shake")}).bind("touchend",function(){$(".trigger").removeClass("recording"),n.stop(),$("#status").text("Touch Shake Stop")})}function b(){p.play("clap"),f()}function c(){p.play("kick"),f()}function d(){p.play("low"),f()}function e(){p.play("snare"),f()}function f(){UberVizMain.setBeat(Math.random()+.1)}function g(){o="shake",$("#shakeBtn").text("stop"),i()}function h(){o=null,$("#shakeBtn").text("shake"),n.stop()}function i(){function a(){j(),$("body").addClass("active")}n=new Shake({threshold:2,timeout:400}),n.start(),window.addEventListener("shake",a,!1)}function j(){console.log("shaking"),l>0?b():c(),f()}UberVizMain.init();var k,l,m,n,o=null;console.log("loaded"),$("#status").text("loaded"),$(".trigger").hide(),$("#playBtn").on("click",function(){$("#playBtn").remove(),a()});var p=new Howl({urls:["audio/soundmix01.mp3"],sprite:{clap:[0,300],kick:[400,300],low:[1e3,300],snare:[2600,300]}});p.play("kick"),$("#clapBtn").on("click",function(){b()}),$("#kickBtn").on("click",function(){c()}),$("#lowBtn").on("click",function(){d()}),$("#snareBtn").on("click",function(){e()}),$("#shakeBtn").click(function(){"shake"==o?h():g()}),window.matchMedia("(min-width: 500px)").matches||$(".container").hide();var q=30,r={x:$(window).width()/2,y:$(window).height()/2},s=function(a){$(".ball").css({transform:"rotateZ("+a+"deg)"})},t=function(a,b){$(".ball").css({top:Math.ceil(r.y+b*q),left:Math.ceil(r.x+-1*a*q)})};s(90,45,45),t(0,0,0);var u=function(){var a=document.getElementById("dataContainerOrientation"),b=document.getElementById("dataContainerMotion");window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(b){var c=b.alpha,d=b.beta,e=b.gamma;(null!=c||null!=d||null!=e)&&(a.innerHTML="alpha: "+c+"<br/>beta: "+d+"<br />gamma: "+e,s(c,d,e))},!1),window.DeviceMotionEvent&&window.addEventListener("devicemotion",function(a){l=Math.floor(a.accelerationIncludingGravity.x),m=a.accelerationIncludingGravity.y;var c=a.accelerationIncludingGravity.z,d=a.rotationRate,e="Acceleration:<br />";if(e+="x: "+l+"<br />y: "+m+"<br/>z: "+c+"<br />",e+="Rotation rate:<br />",null!=d&&(e+="alpha: "+d.alpha+"<br />beta: "+d.beta+"<br/>gamma: "+d.gamma+"<br />"),b.innerHTML=e,t(l,m,c),"tilt"==o){var f=1e3*l/5;k.detune.value=f,$("#status").html(f),console.log("ready")}})};u()});