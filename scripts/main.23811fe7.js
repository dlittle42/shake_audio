function Events(a){var b,c,d,e={},f=Array;a=a||this,a.on=function(a,b,c){e[a]||(e[a]=[]),e[a].push({f:b,c:c})},a.off=function(a,d){for(c=e[a]||[],b=c.length=d?c.length:0;~--b<0;)d==c[b].f&&c.splice(b,1)},a.emit=function(){for(d=f.apply([],arguments),c=e[d.shift()]||[],d=d[0]instanceof f&&d[0]||d,b=c.length;~--b<0;)c[b].f.apply(c[b].c,d)}}var SimplexNoise=function(a){void 0==a&&(a=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var b=0;256>b;b++)this.p[b]=Math.floor(256*a.random());this.perm=[];for(var b=0;512>b;b++)this.perm[b]=this.p[255&b];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};SimplexNoise.prototype.dot=function(a,b,c){return a[0]*b+a[1]*c},SimplexNoise.prototype.dot3=function(a,b,c,d){return a[0]*b+a[1]*c+a[2]*d},SimplexNoise.prototype.dot4=function(a,b,c,d,e){return a[0]*b+a[1]*c+a[2]*d+a[3]*e},SimplexNoise.prototype.noise=function(a,b){var c,d,e,f,g,h=.5*(Math.sqrt(3)-1),i=(a+b)*h,j=Math.floor(a+i),k=Math.floor(b+i),l=(3-Math.sqrt(3))/6,m=(j+k)*l,n=j-m,o=k-m,p=a-n,q=b-o;p>q?(f=1,g=0):(f=0,g=1);var r=p-f+l,s=q-g+l,t=p-1+2*l,u=q-1+2*l,v=255&j,w=255&k,x=this.perm[v+this.perm[w]]%12,y=this.perm[v+f+this.perm[w+g]]%12,z=this.perm[v+1+this.perm[w+1]]%12,A=.5-p*p-q*q;0>A?c=0:(A*=A,c=A*A*this.dot(this.grad3[x],p,q));var B=.5-r*r-s*s;0>B?d=0:(B*=B,d=B*B*this.dot(this.grad3[y],r,s));var C=.5-t*t-u*u;return 0>C?e=0:(C*=C,e=C*C*this.dot(this.grad3[z],t,u)),70*(c+d+e)},SimplexNoise.prototype.noise3d=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=1/3,o=(a+b+c)*n,p=Math.floor(a+o),q=Math.floor(b+o),r=Math.floor(c+o),s=1/6,t=(p+q+r)*s,u=p-t,v=q-t,w=r-t,x=a-u,y=b-v,z=c-w;x>=y?y>=z?(h=1,i=0,j=0,k=1,l=1,m=0):x>=z?(h=1,i=0,j=0,k=1,l=0,m=1):(h=0,i=0,j=1,k=1,l=0,m=1):z>y?(h=0,i=0,j=1,k=0,l=1,m=1):z>x?(h=0,i=1,j=0,k=0,l=1,m=1):(h=0,i=1,j=0,k=1,l=1,m=0);var A=x-h+s,B=y-i+s,C=z-j+s,D=x-k+2*s,E=y-l+2*s,F=z-m+2*s,G=x-1+3*s,H=y-1+3*s,I=z-1+3*s,J=255&p,K=255&q,L=255&r,M=this.perm[J+this.perm[K+this.perm[L]]]%12,N=this.perm[J+h+this.perm[K+i+this.perm[L+j]]]%12,O=this.perm[J+k+this.perm[K+l+this.perm[L+m]]]%12,P=this.perm[J+1+this.perm[K+1+this.perm[L+1]]]%12,Q=.6-x*x-y*y-z*z;0>Q?d=0:(Q*=Q,d=Q*Q*this.dot3(this.grad3[M],x,y,z));var R=.6-A*A-B*B-C*C;0>R?e=0:(R*=R,e=R*R*this.dot3(this.grad3[N],A,B,C));var S=.6-D*D-E*E-F*F;0>S?f=0:(S*=S,f=S*S*this.dot3(this.grad3[O],D,E,F));var T=.6-G*G-H*H-I*I;return 0>T?g=0:(T*=T,g=T*T*this.dot3(this.grad3[P],G,H,I)),32*(d+e+f+g)},SimplexNoise.prototype.noise4d=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this.grad4,w=this.simplex,x=this.perm,y=(Math.sqrt(5)-1)/4,z=(5-Math.sqrt(5))/20,A=(a+b+c+d)*y,B=Math.floor(a+A),C=Math.floor(b+A),D=Math.floor(c+A),E=Math.floor(d+A),F=(B+C+D+E)*z,G=B-F,H=C-F,I=D-F,J=E-F,K=a-G,L=b-H,M=c-I,N=d-J,O=K>L?32:0,P=K>M?16:0,Q=L>M?8:0,R=K>N?4:0,S=L>N?2:0,T=M>N?1:0,U=O+P+Q+R+S+T;j=w[U][0]>=3?1:0,k=w[U][1]>=3?1:0,l=w[U][2]>=3?1:0,m=w[U][3]>=3?1:0,n=w[U][0]>=2?1:0,o=w[U][1]>=2?1:0,p=w[U][2]>=2?1:0,q=w[U][3]>=2?1:0,r=w[U][0]>=1?1:0,s=w[U][1]>=1?1:0,t=w[U][2]>=1?1:0,u=w[U][3]>=1?1:0;var V=K-j+z,W=L-k+z,X=M-l+z,Y=N-m+z,Z=K-n+2*z,$=L-o+2*z,_=M-p+2*z,aa=N-q+2*z,ba=K-r+3*z,ca=L-s+3*z,da=M-t+3*z,ea=N-u+3*z,fa=K-1+4*z,ga=L-1+4*z,ha=M-1+4*z,ia=N-1+4*z,ja=255&B,ka=255&C,la=255&D,ma=255&E,na=x[ja+x[ka+x[la+x[ma]]]]%32,oa=x[ja+j+x[ka+k+x[la+l+x[ma+m]]]]%32,pa=x[ja+n+x[ka+o+x[la+p+x[ma+q]]]]%32,qa=x[ja+r+x[ka+s+x[la+t+x[ma+u]]]]%32,ra=x[ja+1+x[ka+1+x[la+1+x[ma+1]]]]%32,sa=.6-K*K-L*L-M*M-N*N;0>sa?e=0:(sa*=sa,e=sa*sa*this.dot4(v[na],K,L,M,N));var ta=.6-V*V-W*W-X*X-Y*Y;0>ta?f=0:(ta*=ta,f=ta*ta*this.dot4(v[oa],V,W,X,Y));var ua=.6-Z*Z-$*$-_*_-aa*aa;0>ua?g=0:(ua*=ua,g=ua*ua*this.dot4(v[pa],Z,$,_,aa));var va=.6-ba*ba-ca*ca-da*da-ea*ea;0>va?h=0:(va*=va,h=va*va*this.dot4(v[qa],ba,ca,da,ea));var wa=.6-fa*fa-ga*ga-ha*ha-ia*ia;return 0>wa?i=0:(wa*=wa,i=wa*wa*this.dot4(v[ra],fa,ga,ha,ia)),27*(e+f+g+h+i)};var events=new Events,simplexNoise=new SimplexNoise;"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1);var UberVizMain=function(){function a(){Detector.webgl||Detector.addGetWebGLMessage(),document.onselectstart=function(){return!1},document.addEventListener("mousemove",h,!1),document.addEventListener("mousedown",f,!1),document.addEventListener("mouseup",g,!1),document.addEventListener("dragover",c,!1),window.addEventListener("resize",i,!1),window.addEventListener("keydown",d,!1),window.addEventListener("keyup",e,!1),m=new Stats,$("#controls").append(m.domElement),m.domElement.id="stats",AudioHandler.init(),VizHandler.init(),FXHandler.init(),i(),b()}function b(){requestAnimationFrame(b),m.update(),events.emit("update")}function c(a){return a.stopPropagation(),a.preventDefault(),!1}function d(a){switch(a.keyCode){case 32:VizHandler.setBeat(Math.random()+.1);break;case 81:}}function e(){}function f(){}function g(){}function h(){}function i(){VizHandler.onResize()}function j(a){$("#debugText").text(a)}function k(){VizHandler.setBeat(Math.random()+.1)}function l(){window.orientation%180==0}var m;return window.onorientationchange=l,window.setTimeout(l,0),{init:a,setBeat:k,trace:j}}();$(document).ready(function(){function a(){$(".trigger").show(),$("body").bind("touchstart",function(){$(".trigger").addClass("recording"),"shake"!=o?g():n.start(),$("#status").text("Touch Shake")}).bind("touchend",function(){$(".trigger").removeClass("recording"),n.stop(),$("#status").text("Touch Shake Stop")})}function b(){p.play("clap"),f()}function c(){p.play("kick"),f()}function d(){p.play("low"),f()}function e(){p.play("snare"),f()}function f(){UberVizMain.setBeat(Math.random()+.1)}function g(){o="shake",$("#shakeBtn").text("stop"),i()}function h(){o=null,$("#shakeBtn").text("shake"),n.stop()}function i(){function a(){j(),$("body").addClass("active")}n=new Shake({threshold:2,timeout:400}),n.start(),window.addEventListener("shake",a,!1)}function j(){console.log("shaking"),l>0?b():c(),f()}UberVizMain.init();var k,l,m,n,o=null;console.log("loaded"),$("#status").text("loaded"),$(".trigger").hide(),$("#playBtn").on("click",function(){$("#playBtn").remove(),a()});var p=new Howl({urls:["audio/soundmix01.mp3"],sprite:{clap:[0,300],kick:[400,300],low:[1e3,300],snare:[2600,300]}});p.play("kick"),$("#clapBtn").on("click",function(){b()}),$("#kickBtn").on("click",function(){c()}),$("#lowBtn").on("click",function(){d()}),$("#snareBtn").on("click",function(){e()}),$("#shakeBtn").click(function(){"shake"==o?h():g()}),window.matchMedia("(min-width: 500px)").matches||$(".container").hide();var q=30,r={x:$(window).width()/2,y:$(window).height()/2},s=function(a){$(".ball").css({transform:"rotateZ("+a+"deg)"})},t=function(a,b){$(".ball").css({top:Math.ceil(r.y+b*q),left:Math.ceil(r.x+-1*a*q)})};s(90,45,45),t(0,0,0);var u=function(){var a=document.getElementById("dataContainerOrientation"),b=document.getElementById("dataContainerMotion");window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(b){var c=b.alpha,d=b.beta,e=b.gamma;(null!=c||null!=d||null!=e)&&(a.innerHTML="alpha: "+c+"<br/>beta: "+d+"<br />gamma: "+e,s(c,d,e))},!1),window.DeviceMotionEvent&&window.addEventListener("devicemotion",function(a){l=Math.floor(a.accelerationIncludingGravity.x),m=a.accelerationIncludingGravity.y;var c=a.accelerationIncludingGravity.z,d=a.rotationRate,e="Acceleration:<br />";if(e+="x: "+l+"<br />y: "+m+"<br/>z: "+c+"<br />",e+="Rotation rate:<br />",null!=d&&(e+="alpha: "+d.alpha+"<br />beta: "+d.beta+"<br/>gamma: "+d.gamma+"<br />"),b.innerHTML=e,t(l,m,c),"tilt"==o){var f=1e3*l/5;k.detune.value=f,$("#status").html(f),console.log("ready")}})};u()});